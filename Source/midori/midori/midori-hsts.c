/* midori-hsts.c generated by valac 0.20.1, the Vala compiler
 * generated from midori-hsts.vala, do not modify */

/*
 Copyright (C) 2012 Christian Dywan <christian@twotoasts.de>

 This library is free software; you can redistribute it and/or
 modify it under the terms of the GNU Lesser General Public
 License as published by the Free Software Foundation; either
 version 2.1 of the License, or (at your option) any later version.

 See the file COPYING for the full license text.
*/

#include <glib.h>
#include <glib-object.h>
#include <libsoup/soup.h>
#include <stdlib.h>
#include <string.h>
#include <gio/gio.h>
#include <stdio.h>
#include <gobject/gvaluecollector.h>


#define MIDORI_TYPE_HSTS (midori_hsts_get_type ())
#define MIDORI_HSTS(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), MIDORI_TYPE_HSTS, MidoriHSTS))
#define MIDORI_HSTS_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), MIDORI_TYPE_HSTS, MidoriHSTSClass))
#define MIDORI_IS_HSTS(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), MIDORI_TYPE_HSTS))
#define MIDORI_IS_HSTS_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), MIDORI_TYPE_HSTS))
#define MIDORI_HSTS_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), MIDORI_TYPE_HSTS, MidoriHSTSClass))

typedef struct _MidoriHSTS MidoriHSTS;
typedef struct _MidoriHSTSClass MidoriHSTSClass;
typedef struct _MidoriHSTSPrivate MidoriHSTSPrivate;

#define MIDORI_HSTS_TYPE_DIRECTIVE (midori_hsts_directive_get_type ())
#define MIDORI_HSTS_DIRECTIVE(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), MIDORI_HSTS_TYPE_DIRECTIVE, MidoriHSTSDirective))
#define MIDORI_HSTS_DIRECTIVE_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), MIDORI_HSTS_TYPE_DIRECTIVE, MidoriHSTSDirectiveClass))
#define MIDORI_HSTS_IS_DIRECTIVE(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), MIDORI_HSTS_TYPE_DIRECTIVE))
#define MIDORI_HSTS_IS_DIRECTIVE_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), MIDORI_HSTS_TYPE_DIRECTIVE))
#define MIDORI_HSTS_DIRECTIVE_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), MIDORI_HSTS_TYPE_DIRECTIVE, MidoriHSTSDirectiveClass))

typedef struct _MidoriHSTSDirective MidoriHSTSDirective;
typedef struct _MidoriHSTSDirectiveClass MidoriHSTSDirectiveClass;
#define _g_hash_table_unref0(var) ((var == NULL) ? NULL : (var = (g_hash_table_unref (var), NULL)))
#define _g_object_unref0(var) ((var == NULL) ? NULL : (var = (g_object_unref (var), NULL)))
#define _g_free0(var) (var = (g_free (var), NULL))
#define _midori_hsts_directive_unref0(var) ((var == NULL) ? NULL : (var = (midori_hsts_directive_unref (var), NULL)))
#define _g_error_free0(var) ((var == NULL) ? NULL : (var = (g_error_free (var), NULL)))
typedef struct _MidoriHstsReadCacheData MidoriHstsReadCacheData;
typedef struct _MidoriHSTSDirectivePrivate MidoriHSTSDirectivePrivate;
typedef struct _MidoriHstsAppendToCacheData MidoriHstsAppendToCacheData;
#define __vala_SoupDate_free0(var) ((var == NULL) ? NULL : (var = (_vala_SoupDate_free (var), NULL)))
typedef struct _MidoriHSTSParamSpecDirective MidoriHSTSParamSpecDirective;

struct _MidoriHSTS {
	GObject parent_instance;
	MidoriHSTSPrivate * priv;
};

struct _MidoriHSTSClass {
	GObjectClass parent_class;
};

struct _MidoriHSTSPrivate {
	GHashTable* whitelist;
	gboolean debug;
};

struct _MidoriHstsReadCacheData {
	int _state_;
	GObject* _source_object_;
	GAsyncResult* _res_;
	GSimpleAsyncResult* _async_result;
	MidoriHSTS* self;
	GFile* file;
	GFile* _tmp0_;
	GFileInputStream* _tmp1_;
	GFileInputStream* _tmp2_;
	GFileInputStream* _tmp3_;
	GDataInputStream* _tmp4_;
	GDataInputStream* _tmp5_;
	GDataInputStream* stream;
	GDataInputStream* _tmp6_;
	gchar* _tmp7_;
	gchar* line;
	const gchar* _tmp8_;
	const gchar* _tmp9_;
	gchar** _tmp10_;
	gchar** _tmp11_;
	gchar** parts;
	gint parts_length1;
	gint _parts_size_;
	gboolean _tmp12_;
	gchar** _tmp13_;
	gint _tmp13__length1;
	const gchar* _tmp14_;
	gchar** _tmp15_;
	gint _tmp15__length1;
	const gchar* _tmp16_;
	gboolean _tmp17_;
	gchar** _tmp18_;
	gint _tmp18__length1;
	const gchar* _tmp19_;
	MidoriHSTSDirective* _tmp20_;
	MidoriHSTSDirective* directive;
	MidoriHSTSDirective* _tmp21_;
	gboolean _tmp22_;
	gchar** _tmp23_;
	gint _tmp23__length1;
	const gchar* _tmp24_;
	MidoriHSTSDirective* _tmp25_;
	GError* _error_;
	GError * _inner_error_;
};

struct _MidoriHSTSDirective {
	GTypeInstance parent_instance;
	volatile int ref_count;
	MidoriHSTSDirectivePrivate * priv;
	SoupDate* expires;
	gboolean sub_domains;
};

struct _MidoriHSTSDirectiveClass {
	GTypeClass parent_class;
	void (*finalize) (MidoriHSTSDirective *self);
};

struct _MidoriHstsAppendToCacheData {
	int _state_;
	GObject* _source_object_;
	GAsyncResult* _res_;
	GSimpleAsyncResult* _async_result;
	MidoriHSTS* self;
	gchar* host;
	gchar* header;
	gboolean _tmp0_;
	gchar* _tmp1_;
	gchar* filename;
	const gchar* _tmp2_;
	GFile* _tmp3_;
	GFile* file;
	GFile* _tmp4_;
	GFileOutputStream* _tmp5_;
	GFileOutputStream* stream;
	GFileOutputStream* _tmp6_;
	const gchar* _tmp7_;
	gchar* _tmp8_;
	gchar* _tmp9_;
	const gchar* _tmp10_;
	gchar* _tmp11_;
	gchar* _tmp12_;
	gchar* _tmp13_;
	gchar* _tmp14_;
	guint8* _tmp15_;
	gint _tmp15__length1;
	guint8* _tmp16_;
	gint _tmp16__length1;
	GFileOutputStream* _tmp17_;
	GError* _error_;
	const gchar* _tmp18_;
	GError* _tmp19_;
	const gchar* _tmp20_;
	GError * _inner_error_;
};

struct _MidoriHSTSParamSpecDirective {
	GParamSpec parent_instance;
};


static gpointer midori_hsts_parent_class = NULL;
static gpointer midori_hsts_directive_parent_class = NULL;
static SoupSessionFeatureInterface* midori_hsts_soup_session_feature_parent_iface = NULL;

GType midori_hsts_get_type (void) G_GNUC_CONST;
gpointer midori_hsts_directive_ref (gpointer instance);
void midori_hsts_directive_unref (gpointer instance);
GParamSpec* midori_hsts_param_spec_directive (const gchar* name, const gchar* nick, const gchar* blurb, GType object_type, GParamFlags flags);
void midori_hsts_value_set_directive (GValue* value, gpointer v_object);
void midori_hsts_value_take_directive (GValue* value, gpointer v_object);
gpointer midori_hsts_value_get_directive (const GValue* value);
GType midori_hsts_directive_get_type (void) G_GNUC_CONST;
#define MIDORI_HSTS_GET_PRIVATE(o) (G_TYPE_INSTANCE_GET_PRIVATE ((o), MIDORI_TYPE_HSTS, MidoriHSTSPrivate))
enum  {
	MIDORI_HSTS_DUMMY_PROPERTY
};
MidoriHSTS* midori_hsts_new (void);
MidoriHSTS* midori_hsts_construct (GType object_type);
static void _g_free0_ (gpointer var);
static void _midori_hsts_directive_unref0_ (gpointer var);
static void midori_hsts_read_cache (MidoriHSTS* self, GFile* file, GAsyncReadyCallback _callback_, gpointer _user_data_);
static void midori_hsts_read_cache_finish (MidoriHSTS* self, GAsyncResult* _res_);
gchar* midori_paths_get_preset_filename (const gchar* folder, const gchar* filename);
gchar* midori_paths_get_config_filename_for_reading (const gchar* filename);
static void midori_hsts_read_cache_data_free (gpointer _data);
static gboolean midori_hsts_read_cache_co (MidoriHstsReadCacheData* _data_);
static void midori_hsts_read_cache_ready (GObject* source_object, GAsyncResult* _res_, gpointer _user_data_);
MidoriHSTSDirective* midori_hsts_directive_new_from_header (const gchar* header);
MidoriHSTSDirective* midori_hsts_directive_construct_from_header (GType object_type, const gchar* header);
gboolean midori_hsts_directive_is_valid (MidoriHSTSDirective* self);
static void midori_hsts_append_to_whitelist (MidoriHSTS* self, const gchar* host, MidoriHSTSDirective* directive);
static gboolean midori_hsts_real_add_feature (SoupSessionFeature* base, GType type);
static gboolean midori_hsts_real_remove_feature (SoupSessionFeature* base, GType type);
static gboolean midori_hsts_real_has_feature (SoupSessionFeature* base, GType type);
static void midori_hsts_real_attach (SoupSessionFeature* base, SoupSession* session);
static void midori_hsts_queued (MidoriHSTS* self, SoupSession* session, SoupMessage* message);
static void _midori_hsts_queued_soup_session_request_queued (SoupSession* _sender, SoupMessage* msg, gpointer self);
static void midori_hsts_real_detach (SoupSessionFeature* base, SoupSession* session);
static void midori_hsts_real_request_started (SoupSessionFeature* base, SoupSession* session, SoupMessage* msg, SoupSocket* socket);
static void midori_hsts_real_request_queued (SoupSessionFeature* base, SoupSession* session, SoupMessage* message);
static void midori_hsts_real_request_unqueued (SoupSessionFeature* base, SoupSession* session, SoupMessage* msg);
static gboolean midori_hsts_should_secure_host (MidoriHSTS* self, const gchar* host);
static void midori_hsts_strict_transport_security_handled (MidoriHSTS* self, SoupMessage* message);
static void _midori_hsts_strict_transport_security_handled_soup_message_finished (SoupMessage* _sender, gpointer self);
static void midori_hsts_append_to_cache_data_free (gpointer _data);
static void midori_hsts_append_to_cache (MidoriHSTS* self, const gchar* host, const gchar* header, GAsyncReadyCallback _callback_, gpointer _user_data_);
static void midori_hsts_append_to_cache_finish (MidoriHSTS* self, GAsyncResult* _res_);
static gboolean midori_hsts_append_to_cache_co (MidoriHstsAppendToCacheData* _data_);
gboolean midori_paths_is_readonly (void);
gchar* midori_paths_get_config_filename_for_writing (const gchar* filename);
static void midori_hsts_append_to_cache_ready (GObject* source_object, GAsyncResult* _res_, gpointer _user_data_);
enum  {
	MIDORI_HSTS_DIRECTIVE_DUMMY_PROPERTY
};
static void _vala_SoupDate_free (SoupDate* self);
MidoriHSTSDirective* midori_hsts_directive_new (gboolean include_sub_domains);
MidoriHSTSDirective* midori_hsts_directive_construct (GType object_type, gboolean include_sub_domains);
static void midori_hsts_directive_finalize (MidoriHSTSDirective* obj);
static void midori_hsts_finalize (GObject* obj);
static void _vala_array_destroy (gpointer array, gint array_length, GDestroyNotify destroy_func);
static void _vala_array_free (gpointer array, gint array_length, GDestroyNotify destroy_func);
static gint _vala_array_length (gpointer array);


static void _g_free0_ (gpointer var) {
#line 46 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	var = (g_free (var), NULL);
#line 241 "midori-hsts.c"
}


static void _midori_hsts_directive_unref0_ (gpointer var) {
#line 46 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	(var == NULL) ? NULL : (var = (midori_hsts_directive_unref (var), NULL));
#line 248 "midori-hsts.c"
}


MidoriHSTS* midori_hsts_construct (GType object_type) {
	MidoriHSTS * self = NULL;
	GHashFunc _tmp0_;
	GEqualFunc _tmp1_;
	GHashTable* _tmp2_;
	gchar* _tmp3_ = NULL;
	gchar* _tmp4_;
	GFile* _tmp5_ = NULL;
	GFile* _tmp6_;
	gchar* _tmp7_ = NULL;
	gchar* _tmp8_;
	GFile* _tmp9_ = NULL;
	GFile* _tmp10_;
	GCompareFunc _tmp11_;
	const gchar* _tmp12_ = NULL;
	gint _tmp13_ = 0;
#line 45 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	self = (MidoriHSTS*) g_object_new (object_type, NULL);
#line 46 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_tmp0_ = g_str_hash;
#line 46 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_tmp1_ = g_str_equal;
#line 46 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_tmp2_ = g_hash_table_new_full (_tmp0_, _tmp1_, _g_free0_, _midori_hsts_directive_unref0_);
#line 46 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_g_hash_table_unref0 (self->priv->whitelist);
#line 46 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	self->priv->whitelist = _tmp2_;
#line 47 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_tmp3_ = midori_paths_get_preset_filename (NULL, "hsts");
#line 47 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_tmp4_ = _tmp3_;
#line 47 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_tmp5_ = g_file_new_for_path (_tmp4_);
#line 47 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_tmp6_ = _tmp5_;
#line 47 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	midori_hsts_read_cache (self, _tmp6_, NULL, NULL);
#line 47 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_g_object_unref0 (_tmp6_);
#line 47 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_g_free0 (_tmp4_);
#line 48 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_tmp7_ = midori_paths_get_config_filename_for_reading ("hsts");
#line 48 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_tmp8_ = _tmp7_;
#line 48 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_tmp9_ = g_file_new_for_path (_tmp8_);
#line 48 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_tmp10_ = _tmp9_;
#line 48 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	midori_hsts_read_cache (self, _tmp10_, NULL, NULL);
#line 48 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_g_object_unref0 (_tmp10_);
#line 48 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_g_free0 (_tmp8_);
#line 49 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_tmp11_ = g_strcmp0;
#line 49 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_tmp12_ = g_getenv ("MIDORI_DEBUG");
#line 49 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_tmp13_ = _tmp11_ (_tmp12_, "hsts");
#line 49 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	if (_tmp13_ == 0) {
#line 50 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		self->priv->debug = TRUE;
#line 318 "midori-hsts.c"
	}
#line 45 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	return self;
#line 322 "midori-hsts.c"
}


MidoriHSTS* midori_hsts_new (void) {
#line 45 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	return midori_hsts_construct (MIDORI_TYPE_HSTS);
#line 329 "midori-hsts.c"
}


static void midori_hsts_read_cache_data_free (gpointer _data) {
	MidoriHstsReadCacheData* _data_;
	_data_ = _data;
#line 13 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_g_object_unref0 (_data_->file);
#line 13 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_g_object_unref0 (_data_->self);
#line 13 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	g_slice_free (MidoriHstsReadCacheData, _data_);
#line 342 "midori-hsts.c"
}


static gpointer _g_object_ref0 (gpointer self) {
#line 13 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	return self ? g_object_ref (self) : NULL;
#line 349 "midori-hsts.c"
}


static void midori_hsts_read_cache (MidoriHSTS* self, GFile* file, GAsyncReadyCallback _callback_, gpointer _user_data_) {
	MidoriHstsReadCacheData* _data_;
	MidoriHSTS* _tmp0_;
	GFile* _tmp1_;
	GFile* _tmp2_;
#line 13 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_data_ = g_slice_new0 (MidoriHstsReadCacheData);
#line 13 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_data_->_async_result = g_simple_async_result_new (G_OBJECT (self), _callback_, _user_data_, midori_hsts_read_cache);
#line 13 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	g_simple_async_result_set_op_res_gpointer (_data_->_async_result, _data_, midori_hsts_read_cache_data_free);
#line 13 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_tmp0_ = _g_object_ref0 (self);
#line 13 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_data_->self = _tmp0_;
#line 13 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_tmp1_ = file;
#line 13 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_tmp2_ = _g_object_ref0 (_tmp1_);
#line 13 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_g_object_unref0 (_data_->file);
#line 13 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_data_->file = _tmp2_;
#line 13 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	midori_hsts_read_cache_co (_data_);
#line 378 "midori-hsts.c"
}


static void midori_hsts_read_cache_finish (MidoriHSTS* self, GAsyncResult* _res_) {
	MidoriHstsReadCacheData* _data_;
#line 13 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_data_ = g_simple_async_result_get_op_res_gpointer (G_SIMPLE_ASYNC_RESULT (_res_));
#line 386 "midori-hsts.c"
}


static void midori_hsts_read_cache_ready (GObject* source_object, GAsyncResult* _res_, gpointer _user_data_) {
	MidoriHstsReadCacheData* _data_;
#line 55 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_data_ = _user_data_;
#line 55 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_data_->_source_object_ = source_object;
#line 55 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_data_->_res_ = _res_;
#line 55 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	midori_hsts_read_cache_co (_data_);
#line 400 "midori-hsts.c"
}


static gboolean midori_hsts_read_cache_co (MidoriHstsReadCacheData* _data_) {
#line 53 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	switch (_data_->_state_) {
#line 53 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		case 0:
#line 409 "midori-hsts.c"
		goto _state_0;
#line 53 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		case 1:
#line 413 "midori-hsts.c"
		goto _state_1;
#line 53 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		case 2:
#line 417 "midori-hsts.c"
		goto _state_2;
		default:
#line 53 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		g_assert_not_reached ();
#line 422 "midori-hsts.c"
	}
	_state_0:
	{
#line 55 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_data_->_tmp0_ = _data_->file;
#line 55 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_data_->_state_ = 1;
#line 55 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		g_file_read_async (_data_->_tmp0_, G_PRIORITY_DEFAULT, NULL, midori_hsts_read_cache_ready, _data_);
#line 55 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		return FALSE;
#line 434 "midori-hsts.c"
		_state_1:
#line 55 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_data_->_tmp1_ = NULL;
#line 55 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_data_->_tmp1_ = g_file_read_finish (_data_->_tmp0_, _data_->_res_, &_data_->_inner_error_);
#line 55 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_data_->_tmp2_ = _data_->_tmp1_;
#line 55 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		if (_data_->_inner_error_ != NULL) {
#line 444 "midori-hsts.c"
			goto __catch9_g_error;
		}
#line 55 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_data_->_tmp3_ = _data_->_tmp2_;
#line 55 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_data_->_tmp4_ = g_data_input_stream_new ((GInputStream*) _data_->_tmp3_);
#line 55 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_data_->_tmp5_ = _data_->_tmp4_;
#line 55 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_g_object_unref0 (_data_->_tmp3_);
#line 55 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_data_->stream = _data_->_tmp5_;
#line 56 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		while (TRUE) {
#line 57 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
			_data_->_tmp6_ = _data_->stream;
#line 57 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
			_data_->_state_ = 2;
#line 57 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
			g_data_input_stream_read_line_async (_data_->_tmp6_, G_PRIORITY_DEFAULT, NULL, midori_hsts_read_cache_ready, _data_);
#line 57 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
			return FALSE;
#line 467 "midori-hsts.c"
			_state_2:
#line 57 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
			_data_->_tmp7_ = NULL;
#line 57 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
			_data_->_tmp7_ = g_data_input_stream_read_line_finish (_data_->_tmp6_, _data_->_res_, NULL, &_data_->_inner_error_);
#line 57 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
			_data_->line = _data_->_tmp7_;
#line 57 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
			if (_data_->_inner_error_ != NULL) {
#line 57 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
				_g_object_unref0 (_data_->stream);
#line 479 "midori-hsts.c"
				goto __catch9_g_error;
			}
#line 58 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
			_data_->_tmp8_ = _data_->line;
#line 58 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
			if (_data_->_tmp8_ == NULL) {
#line 59 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
				_g_free0 (_data_->line);
#line 59 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
				break;
#line 490 "midori-hsts.c"
			}
#line 60 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
			_data_->_tmp9_ = _data_->line;
#line 60 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
			_data_->_tmp11_ = NULL;
#line 60 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
			_data_->_tmp11_ = _data_->_tmp10_ = g_strsplit (_data_->_tmp9_, " ", 2);
#line 60 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
			_data_->parts = _data_->_tmp11_;
#line 60 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
			_data_->parts_length1 = _vala_array_length (_data_->_tmp10_);
#line 60 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
			_data_->_parts_size_ = _data_->parts_length1;
#line 61 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
			_data_->_tmp13_ = _data_->parts;
#line 61 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
			_data_->_tmp13__length1 = _data_->parts_length1;
#line 61 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
			_data_->_tmp14_ = _data_->_tmp13_[0];
#line 61 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
			if (_data_->_tmp14_ == NULL) {
#line 61 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
				_data_->_tmp12_ = TRUE;
#line 514 "midori-hsts.c"
			} else {
#line 61 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
				_data_->_tmp15_ = _data_->parts;
#line 61 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
				_data_->_tmp15__length1 = _data_->parts_length1;
#line 61 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
				_data_->_tmp16_ = _data_->_tmp15_[1];
#line 61 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
				_data_->_tmp12_ = _data_->_tmp16_ == NULL;
#line 524 "midori-hsts.c"
			}
#line 61 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
			_data_->_tmp17_ = _data_->_tmp12_;
#line 61 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
			if (_data_->_tmp17_) {
#line 62 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
				_data_->parts = (_vala_array_free (_data_->parts, _data_->parts_length1, (GDestroyNotify) g_free), NULL);
#line 62 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
				_g_free0 (_data_->line);
#line 62 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
				break;
#line 536 "midori-hsts.c"
			}
#line 63 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
			_data_->_tmp18_ = _data_->parts;
#line 63 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
			_data_->_tmp18__length1 = _data_->parts_length1;
#line 63 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
			_data_->_tmp19_ = _data_->_tmp18_[1];
#line 63 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
			_data_->_tmp20_ = midori_hsts_directive_new_from_header (_data_->_tmp19_);
#line 63 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
			_data_->directive = _data_->_tmp20_;
#line 64 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
			_data_->_tmp21_ = _data_->directive;
#line 64 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
			_data_->_tmp22_ = FALSE;
#line 64 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
			_data_->_tmp22_ = midori_hsts_directive_is_valid (_data_->_tmp21_);
#line 64 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
			if (_data_->_tmp22_) {
#line 65 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
				_data_->_tmp23_ = _data_->parts;
#line 65 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
				_data_->_tmp23__length1 = _data_->parts_length1;
#line 65 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
				_data_->_tmp24_ = _data_->_tmp23_[0];
#line 65 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
				_data_->_tmp25_ = _data_->directive;
#line 65 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
				midori_hsts_append_to_whitelist (_data_->self, _data_->_tmp24_, _data_->_tmp25_);
#line 566 "midori-hsts.c"
			}
#line 56 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
			_midori_hsts_directive_unref0 (_data_->directive);
#line 56 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
			_data_->parts = (_vala_array_free (_data_->parts, _data_->parts_length1, (GDestroyNotify) g_free), NULL);
#line 56 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
			_g_free0 (_data_->line);
#line 574 "midori-hsts.c"
		}
#line 54 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_g_object_unref0 (_data_->stream);
#line 578 "midori-hsts.c"
	}
	goto __finally9;
	__catch9_g_error:
	{
#line 54 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_data_->_error_ = _data_->_inner_error_;
#line 54 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_data_->_inner_error_ = NULL;
#line 54 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_g_error_free0 (_data_->_error_);
#line 589 "midori-hsts.c"
	}
	__finally9:
#line 54 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	if (_data_->_inner_error_ != NULL) {
#line 54 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _data_->_inner_error_->message, g_quark_to_string (_data_->_inner_error_->domain), _data_->_inner_error_->code);
#line 54 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		g_clear_error (&_data_->_inner_error_);
#line 54 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		return FALSE;
#line 600 "midori-hsts.c"
	}
#line 53 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	if (_data_->_state_ == 0) {
#line 53 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		g_simple_async_result_complete_in_idle (_data_->_async_result);
#line 606 "midori-hsts.c"
	} else {
#line 53 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		g_simple_async_result_complete (_data_->_async_result);
#line 610 "midori-hsts.c"
	}
#line 53 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	g_object_unref (_data_->_async_result);
#line 53 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	return FALSE;
#line 616 "midori-hsts.c"
}


static gboolean midori_hsts_real_add_feature (SoupSessionFeature* base, GType type) {
	MidoriHSTS * self;
	gboolean result = FALSE;
#line 73 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	self = (MidoriHSTS*) base;
#line 73 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	result = FALSE;
#line 73 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	return result;
#line 629 "midori-hsts.c"
}


static gboolean midori_hsts_real_remove_feature (SoupSessionFeature* base, GType type) {
	MidoriHSTS * self;
	gboolean result = FALSE;
#line 74 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	self = (MidoriHSTS*) base;
#line 74 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	result = FALSE;
#line 74 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	return result;
#line 642 "midori-hsts.c"
}


static gboolean midori_hsts_real_has_feature (SoupSessionFeature* base, GType type) {
	MidoriHSTS * self;
	gboolean result = FALSE;
#line 75 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	self = (MidoriHSTS*) base;
#line 75 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	result = FALSE;
#line 75 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	return result;
#line 655 "midori-hsts.c"
}


static void _midori_hsts_queued_soup_session_request_queued (SoupSession* _sender, SoupMessage* msg, gpointer self) {
#line 78 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	midori_hsts_queued (self, _sender, msg);
#line 662 "midori-hsts.c"
}


static void midori_hsts_real_attach (SoupSessionFeature* base, SoupSession* session) {
	MidoriHSTS * self;
	SoupSession* _tmp0_;
#line 78 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	self = (MidoriHSTS*) base;
#line 78 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	g_return_if_fail (session != NULL);
#line 78 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_tmp0_ = session;
#line 78 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	g_signal_connect_object (_tmp0_, "request-queued", (GCallback) _midori_hsts_queued_soup_session_request_queued, self, 0);
#line 677 "midori-hsts.c"
}


static void midori_hsts_real_detach (SoupSessionFeature* base, SoupSession* session) {
	MidoriHSTS * self;
#line 79 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	self = (MidoriHSTS*) base;
#line 79 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	g_return_if_fail (session != NULL);
#line 687 "midori-hsts.c"
}


static void midori_hsts_real_request_started (SoupSessionFeature* base, SoupSession* session, SoupMessage* msg, SoupSocket* socket) {
	MidoriHSTS * self;
#line 82 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	self = (MidoriHSTS*) base;
#line 82 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	g_return_if_fail (session != NULL);
#line 82 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	g_return_if_fail (msg != NULL);
#line 82 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	g_return_if_fail (socket != NULL);
#line 701 "midori-hsts.c"
}


static void midori_hsts_real_request_queued (SoupSessionFeature* base, SoupSession* session, SoupMessage* message) {
	MidoriHSTS * self;
#line 83 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	self = (MidoriHSTS*) base;
#line 83 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	g_return_if_fail (session != NULL);
#line 83 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	g_return_if_fail (message != NULL);
#line 713 "midori-hsts.c"
}


static void midori_hsts_real_request_unqueued (SoupSessionFeature* base, SoupSession* session, SoupMessage* msg) {
	MidoriHSTS * self;
#line 84 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	self = (MidoriHSTS*) base;
#line 84 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	g_return_if_fail (session != NULL);
#line 84 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	g_return_if_fail (msg != NULL);
#line 725 "midori-hsts.c"
}


static gpointer _midori_hsts_directive_ref0 (gpointer self) {
#line 87 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	return self ? midori_hsts_directive_ref (self) : NULL;
#line 732 "midori-hsts.c"
}


static gboolean midori_hsts_should_secure_host (MidoriHSTS* self, const gchar* host) {
	gboolean result = FALSE;
	GHashTable* _tmp0_;
	const gchar* _tmp1_;
	gconstpointer _tmp2_ = NULL;
	MidoriHSTSDirective* _tmp3_;
	MidoriHSTSDirective* directive;
	MidoriHSTSDirective* _tmp4_;
	gboolean _tmp11_ = FALSE;
	MidoriHSTSDirective* _tmp12_;
	gboolean _tmp15_;
#line 86 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	g_return_val_if_fail (self != NULL, FALSE);
#line 86 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	g_return_val_if_fail (host != NULL, FALSE);
#line 87 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_tmp0_ = self->priv->whitelist;
#line 87 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_tmp1_ = host;
#line 87 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_tmp2_ = g_hash_table_lookup (_tmp0_, _tmp1_);
#line 87 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_tmp3_ = _midori_hsts_directive_ref0 ((MidoriHSTSDirective*) _tmp2_);
#line 87 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	directive = _tmp3_;
#line 88 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_tmp4_ = directive;
#line 88 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	if (_tmp4_ == NULL) {
#line 765 "midori-hsts.c"
		GHashTable* _tmp5_;
		const gchar* _tmp6_;
		gchar* _tmp7_;
		gchar* _tmp8_;
		gconstpointer _tmp9_ = NULL;
		MidoriHSTSDirective* _tmp10_;
#line 89 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_tmp5_ = self->priv->whitelist;
#line 89 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_tmp6_ = host;
#line 89 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_tmp7_ = g_strconcat ("*.", _tmp6_, NULL);
#line 89 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_tmp8_ = _tmp7_;
#line 89 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_tmp9_ = g_hash_table_lookup (_tmp5_, _tmp8_);
#line 89 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_tmp10_ = _midori_hsts_directive_ref0 ((MidoriHSTSDirective*) _tmp9_);
#line 89 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_midori_hsts_directive_unref0 (directive);
#line 89 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		directive = _tmp10_;
#line 89 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_g_free0 (_tmp8_);
#line 790 "midori-hsts.c"
	}
#line 90 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_tmp12_ = directive;
#line 90 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	if (_tmp12_ != NULL) {
#line 796 "midori-hsts.c"
		MidoriHSTSDirective* _tmp13_;
		gboolean _tmp14_ = FALSE;
#line 90 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_tmp13_ = directive;
#line 90 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_tmp14_ = midori_hsts_directive_is_valid (_tmp13_);
#line 90 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_tmp11_ = _tmp14_;
#line 805 "midori-hsts.c"
	} else {
#line 90 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_tmp11_ = FALSE;
#line 809 "midori-hsts.c"
	}
#line 90 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_tmp15_ = _tmp11_;
#line 90 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	result = _tmp15_;
#line 90 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_midori_hsts_directive_unref0 (directive);
#line 90 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	return result;
#line 819 "midori-hsts.c"
}


static void _midori_hsts_strict_transport_security_handled_soup_message_finished (SoupMessage* _sender, gpointer self) {
#line 101 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	midori_hsts_strict_transport_security_handled (self, _sender);
#line 826 "midori-hsts.c"
}


static void midori_hsts_queued (MidoriHSTS* self, SoupSession* session, SoupMessage* message) {
	SoupMessage* _tmp0_;
	SoupURI* _tmp1_;
	SoupURI* _tmp2_;
	const gchar* _tmp3_;
	gboolean _tmp4_ = FALSE;
#line 93 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	g_return_if_fail (self != NULL);
#line 93 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	g_return_if_fail (session != NULL);
#line 93 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	g_return_if_fail (message != NULL);
#line 94 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_tmp0_ = message;
#line 94 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_tmp1_ = soup_message_get_uri (_tmp0_);
#line 94 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_tmp2_ = _tmp1_;
#line 94 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_tmp3_ = _tmp2_->host;
#line 94 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_tmp4_ = midori_hsts_should_secure_host (self, _tmp3_);
#line 94 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	if (_tmp4_) {
#line 854 "midori-hsts.c"
		SoupMessage* _tmp5_;
		SoupURI* _tmp6_;
		SoupURI* _tmp7_;
		SoupSession* _tmp8_;
		SoupMessage* _tmp9_;
		gboolean _tmp10_;
#line 95 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_tmp5_ = message;
#line 95 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_tmp6_ = soup_message_get_uri (_tmp5_);
#line 95 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_tmp7_ = _tmp6_;
#line 95 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		soup_uri_set_scheme (_tmp7_, "https");
#line 96 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_tmp8_ = session;
#line 96 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_tmp9_ = message;
#line 96 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		soup_session_requeue_message (_tmp8_, _tmp9_);
#line 97 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_tmp10_ = self->priv->debug;
#line 97 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		if (_tmp10_) {
#line 879 "midori-hsts.c"
			FILE* _tmp11_;
			SoupMessage* _tmp12_;
			SoupURI* _tmp13_;
			SoupURI* _tmp14_;
			const gchar* _tmp15_;
#line 98 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
			_tmp11_ = stdout;
#line 98 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
			_tmp12_ = message;
#line 98 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
			_tmp13_ = soup_message_get_uri (_tmp12_);
#line 98 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
			_tmp14_ = _tmp13_;
#line 98 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
			_tmp15_ = _tmp14_->host;
#line 98 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
			fprintf (_tmp11_, "HSTS: Enforce %s\n", _tmp15_);
#line 897 "midori-hsts.c"
		}
	} else {
		SoupMessage* _tmp16_;
		SoupURI* _tmp17_;
		SoupURI* _tmp18_;
		const gchar* _tmp19_;
#line 100 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_tmp16_ = message;
#line 100 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_tmp17_ = soup_message_get_uri (_tmp16_);
#line 100 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_tmp18_ = _tmp17_;
#line 100 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_tmp19_ = _tmp18_->scheme;
#line 100 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		if (g_strcmp0 (_tmp19_, "http") == 0) {
#line 914 "midori-hsts.c"
			SoupMessage* _tmp20_;
#line 101 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
			_tmp20_ = message;
#line 101 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
			g_signal_connect_object (_tmp20_, "finished", (GCallback) _midori_hsts_strict_transport_security_handled_soup_message_finished, self, 0);
#line 920 "midori-hsts.c"
		}
	}
}


static void midori_hsts_append_to_whitelist (MidoriHSTS* self, const gchar* host, MidoriHSTSDirective* directive) {
	GHashTable* _tmp0_;
	const gchar* _tmp1_;
	gchar* _tmp2_;
	MidoriHSTSDirective* _tmp3_;
	MidoriHSTSDirective* _tmp4_;
	MidoriHSTSDirective* _tmp5_;
	gboolean _tmp6_;
#line 104 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	g_return_if_fail (self != NULL);
#line 104 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	g_return_if_fail (host != NULL);
#line 104 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	g_return_if_fail (directive != NULL);
#line 105 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_tmp0_ = self->priv->whitelist;
#line 105 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_tmp1_ = host;
#line 105 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_tmp2_ = g_strdup (_tmp1_);
#line 105 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_tmp3_ = directive;
#line 105 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_tmp4_ = _midori_hsts_directive_ref0 (_tmp3_);
#line 105 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	g_hash_table_insert (_tmp0_, _tmp2_, _tmp4_);
#line 106 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_tmp5_ = directive;
#line 106 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_tmp6_ = _tmp5_->sub_domains;
#line 106 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	if (_tmp6_) {
#line 958 "midori-hsts.c"
		GHashTable* _tmp7_;
		const gchar* _tmp8_;
		gchar* _tmp9_;
		MidoriHSTSDirective* _tmp10_;
		MidoriHSTSDirective* _tmp11_;
#line 107 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_tmp7_ = self->priv->whitelist;
#line 107 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_tmp8_ = host;
#line 107 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_tmp9_ = g_strconcat ("*.", _tmp8_, NULL);
#line 107 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_tmp10_ = directive;
#line 107 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_tmp11_ = _midori_hsts_directive_ref0 (_tmp10_);
#line 107 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		g_hash_table_insert (_tmp7_, _tmp9_, _tmp11_);
#line 976 "midori-hsts.c"
	}
}


static void midori_hsts_append_to_cache_data_free (gpointer _data) {
	MidoriHstsAppendToCacheData* _data_;
	_data_ = _data;
#line 13 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_g_free0 (_data_->host);
#line 13 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_g_free0 (_data_->header);
#line 13 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_g_object_unref0 (_data_->self);
#line 13 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	g_slice_free (MidoriHstsAppendToCacheData, _data_);
#line 992 "midori-hsts.c"
}


static void midori_hsts_append_to_cache (MidoriHSTS* self, const gchar* host, const gchar* header, GAsyncReadyCallback _callback_, gpointer _user_data_) {
	MidoriHstsAppendToCacheData* _data_;
	MidoriHSTS* _tmp0_;
	const gchar* _tmp1_;
	gchar* _tmp2_;
	const gchar* _tmp3_;
	gchar* _tmp4_;
#line 13 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_data_ = g_slice_new0 (MidoriHstsAppendToCacheData);
#line 13 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_data_->_async_result = g_simple_async_result_new (G_OBJECT (self), _callback_, _user_data_, midori_hsts_append_to_cache);
#line 13 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	g_simple_async_result_set_op_res_gpointer (_data_->_async_result, _data_, midori_hsts_append_to_cache_data_free);
#line 13 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_tmp0_ = _g_object_ref0 (self);
#line 13 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_data_->self = _tmp0_;
#line 13 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_tmp1_ = host;
#line 13 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_tmp2_ = g_strdup (_tmp1_);
#line 13 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_g_free0 (_data_->host);
#line 13 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_data_->host = _tmp2_;
#line 13 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_tmp3_ = header;
#line 13 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_tmp4_ = g_strdup (_tmp3_);
#line 13 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_g_free0 (_data_->header);
#line 13 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_data_->header = _tmp4_;
#line 13 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	midori_hsts_append_to_cache_co (_data_);
#line 1031 "midori-hsts.c"
}


static void midori_hsts_append_to_cache_finish (MidoriHSTS* self, GAsyncResult* _res_) {
	MidoriHstsAppendToCacheData* _data_;
#line 13 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_data_ = g_simple_async_result_get_op_res_gpointer (G_SIMPLE_ASYNC_RESULT (_res_));
#line 1039 "midori-hsts.c"
}


static guint8* string_get_data (const gchar* self, int* result_length1) {
	guint8* result;
	guint8* res;
	gint res_length1;
	gint _res_size_;
	gint _tmp0_;
	gint _tmp1_;
	gint _tmp2_;
	guint8* _tmp3_;
	gint _tmp3__length1;
	guint8* _tmp4_;
	gint _tmp4__length1;
#line 1260 "/usr/share/vala-0.20/vapi/glib-2.0.vapi"
	g_return_val_if_fail (self != NULL, NULL);
#line 1261 "/usr/share/vala-0.20/vapi/glib-2.0.vapi"
	res = (guint8*) self;
#line 1261 "/usr/share/vala-0.20/vapi/glib-2.0.vapi"
	res_length1 = -1;
#line 1261 "/usr/share/vala-0.20/vapi/glib-2.0.vapi"
	_res_size_ = res_length1;
#line 1262 "/usr/share/vala-0.20/vapi/glib-2.0.vapi"
	_tmp0_ = strlen (self);
#line 1262 "/usr/share/vala-0.20/vapi/glib-2.0.vapi"
	_tmp1_ = _tmp0_;
#line 1262 "/usr/share/vala-0.20/vapi/glib-2.0.vapi"
	res_length1 = (gint) _tmp1_;
#line 1262 "/usr/share/vala-0.20/vapi/glib-2.0.vapi"
	_tmp2_ = res_length1;
#line 1263 "/usr/share/vala-0.20/vapi/glib-2.0.vapi"
	_tmp3_ = res;
#line 1263 "/usr/share/vala-0.20/vapi/glib-2.0.vapi"
	_tmp3__length1 = res_length1;
#line 1263 "/usr/share/vala-0.20/vapi/glib-2.0.vapi"
	_tmp4_ = _tmp3_;
#line 1263 "/usr/share/vala-0.20/vapi/glib-2.0.vapi"
	_tmp4__length1 = _tmp3__length1;
#line 1263 "/usr/share/vala-0.20/vapi/glib-2.0.vapi"
	if (result_length1) {
#line 1263 "/usr/share/vala-0.20/vapi/glib-2.0.vapi"
		*result_length1 = _tmp4__length1;
#line 1083 "midori-hsts.c"
	}
#line 1263 "/usr/share/vala-0.20/vapi/glib-2.0.vapi"
	result = _tmp4_;
#line 1263 "/usr/share/vala-0.20/vapi/glib-2.0.vapi"
	return result;
#line 1089 "midori-hsts.c"
}


static void midori_hsts_append_to_cache_ready (GObject* source_object, GAsyncResult* _res_, gpointer _user_data_) {
	MidoriHstsAppendToCacheData* _data_;
#line 118 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_data_ = _user_data_;
#line 118 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_data_->_source_object_ = source_object;
#line 118 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_data_->_res_ = _res_;
#line 118 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	midori_hsts_append_to_cache_co (_data_);
#line 1103 "midori-hsts.c"
}


static gboolean midori_hsts_append_to_cache_co (MidoriHstsAppendToCacheData* _data_) {
#line 110 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	switch (_data_->_state_) {
#line 110 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		case 0:
#line 1112 "midori-hsts.c"
		goto _state_0;
#line 110 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		case 1:
#line 1116 "midori-hsts.c"
		goto _state_1;
#line 110 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		case 2:
#line 1120 "midori-hsts.c"
		goto _state_2;
		default:
#line 110 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		g_assert_not_reached ();
#line 1125 "midori-hsts.c"
	}
	_state_0:
#line 111 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_data_->_tmp0_ = FALSE;
#line 111 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_data_->_tmp0_ = midori_paths_is_readonly ();
#line 111 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	if (_data_->_tmp0_) {
#line 112 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		if (_data_->_state_ == 0) {
#line 112 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
			g_simple_async_result_complete_in_idle (_data_->_async_result);
#line 1138 "midori-hsts.c"
		} else {
#line 112 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
			g_simple_async_result_complete (_data_->_async_result);
#line 1142 "midori-hsts.c"
		}
#line 112 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		g_object_unref (_data_->_async_result);
#line 112 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		return FALSE;
#line 1148 "midori-hsts.c"
	}
#line 114 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_data_->_tmp1_ = NULL;
#line 114 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_data_->_tmp1_ = midori_paths_get_config_filename_for_writing ("hsts");
#line 114 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_data_->filename = _data_->_tmp1_;
#line 1156 "midori-hsts.c"
	{
#line 116 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_data_->_tmp2_ = _data_->filename;
#line 116 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_data_->_tmp3_ = NULL;
#line 116 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_data_->_tmp3_ = g_file_new_for_path (_data_->_tmp2_);
#line 116 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_data_->file = _data_->_tmp3_;
#line 117 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_data_->_tmp4_ = _data_->file;
#line 117 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_data_->_tmp5_ = NULL;
#line 117 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_data_->_tmp5_ = g_file_append_to (_data_->_tmp4_, G_FILE_CREATE_NONE, NULL, &_data_->_inner_error_);
#line 117 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_data_->stream = _data_->_tmp5_;
#line 117 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		if (_data_->_inner_error_ != NULL) {
#line 117 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
			_g_object_unref0 (_data_->file);
#line 1178 "midori-hsts.c"
			goto __catch10_g_error;
		}
#line 118 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_data_->_tmp6_ = _data_->stream;
#line 118 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_data_->_tmp7_ = _data_->host;
#line 118 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_data_->_tmp8_ = g_strconcat (_data_->_tmp7_, " ", NULL);
#line 118 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_data_->_tmp9_ = _data_->_tmp8_;
#line 118 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_data_->_tmp10_ = _data_->header;
#line 118 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_data_->_tmp11_ = g_strconcat (_data_->_tmp9_, _data_->_tmp10_, NULL);
#line 118 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_data_->_tmp12_ = _data_->_tmp11_;
#line 118 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_data_->_tmp13_ = g_strconcat (_data_->_tmp12_, "\n", NULL);
#line 118 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_data_->_tmp14_ = _data_->_tmp13_;
#line 118 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_data_->_tmp15_ = string_get_data (_data_->_tmp14_, &_data_->_tmp15__length1);
#line 118 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_data_->_tmp16_ = _data_->_tmp15_;
#line 118 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_data_->_tmp16__length1 = _data_->_tmp15__length1;
#line 118 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_data_->_state_ = 1;
#line 118 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		g_output_stream_write_async ((GOutputStream*) _data_->_tmp6_, _data_->_tmp16_, (gsize) _data_->_tmp16__length1, G_PRIORITY_DEFAULT, NULL, midori_hsts_append_to_cache_ready, _data_);
#line 118 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		return FALSE;
#line 1211 "midori-hsts.c"
		_state_1:
#line 118 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		g_output_stream_write_finish ((GOutputStream*) _data_->_tmp6_, _data_->_res_, &_data_->_inner_error_);
#line 118 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_g_free0 (_data_->_tmp14_);
#line 118 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_g_free0 (_data_->_tmp12_);
#line 118 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_g_free0 (_data_->_tmp9_);
#line 118 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		if (_data_->_inner_error_ != NULL) {
#line 118 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
			_g_object_unref0 (_data_->stream);
#line 118 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
			_g_object_unref0 (_data_->file);
#line 1227 "midori-hsts.c"
			goto __catch10_g_error;
		}
#line 119 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_data_->_tmp17_ = _data_->stream;
#line 119 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_data_->_state_ = 2;
#line 119 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		g_output_stream_flush_async ((GOutputStream*) _data_->_tmp17_, G_PRIORITY_DEFAULT, NULL, midori_hsts_append_to_cache_ready, _data_);
#line 119 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		return FALSE;
#line 1238 "midori-hsts.c"
		_state_2:
#line 119 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		g_output_stream_flush_finish ((GOutputStream*) _data_->_tmp17_, _data_->_res_, &_data_->_inner_error_);
#line 119 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		if (_data_->_inner_error_ != NULL) {
#line 119 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
			_g_object_unref0 (_data_->stream);
#line 119 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
			_g_object_unref0 (_data_->file);
#line 1248 "midori-hsts.c"
			goto __catch10_g_error;
		}
#line 115 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_g_object_unref0 (_data_->stream);
#line 115 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_g_object_unref0 (_data_->file);
#line 1255 "midori-hsts.c"
	}
	goto __finally10;
	__catch10_g_error:
	{
#line 115 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_data_->_error_ = _data_->_inner_error_;
#line 115 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_data_->_inner_error_ = NULL;
#line 122 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_data_->_tmp18_ = _data_->filename;
#line 122 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_data_->_tmp19_ = _data_->_error_;
#line 122 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_data_->_tmp20_ = _data_->_tmp19_->message;
#line 122 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		g_critical ("midori-hsts.vala:122: Failed to update %s: %s", _data_->_tmp18_, _data_->_tmp20_);
#line 115 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_g_error_free0 (_data_->_error_);
#line 1274 "midori-hsts.c"
	}
	__finally10:
#line 115 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	if (_data_->_inner_error_ != NULL) {
#line 115 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_g_free0 (_data_->filename);
#line 115 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _data_->_inner_error_->message, g_quark_to_string (_data_->_inner_error_->domain), _data_->_inner_error_->code);
#line 115 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		g_clear_error (&_data_->_inner_error_);
#line 115 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		return FALSE;
#line 1287 "midori-hsts.c"
	}
#line 110 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_g_free0 (_data_->filename);
#line 110 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	if (_data_->_state_ == 0) {
#line 110 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		g_simple_async_result_complete_in_idle (_data_->_async_result);
#line 1295 "midori-hsts.c"
	} else {
#line 110 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		g_simple_async_result_complete (_data_->_async_result);
#line 1299 "midori-hsts.c"
	}
#line 110 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	g_object_unref (_data_->_async_result);
#line 110 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	return FALSE;
#line 1305 "midori-hsts.c"
}


static gchar* bool_to_string (gboolean self) {
	gchar* result = NULL;
#line 37 "/usr/share/vala-0.20/vapi/glib-2.0.vapi"
	if (self) {
#line 1313 "midori-hsts.c"
		gchar* _tmp0_;
#line 38 "/usr/share/vala-0.20/vapi/glib-2.0.vapi"
		_tmp0_ = g_strdup ("true");
#line 38 "/usr/share/vala-0.20/vapi/glib-2.0.vapi"
		result = _tmp0_;
#line 38 "/usr/share/vala-0.20/vapi/glib-2.0.vapi"
		return result;
#line 1321 "midori-hsts.c"
	} else {
		gchar* _tmp1_;
#line 40 "/usr/share/vala-0.20/vapi/glib-2.0.vapi"
		_tmp1_ = g_strdup ("false");
#line 40 "/usr/share/vala-0.20/vapi/glib-2.0.vapi"
		result = _tmp1_;
#line 40 "/usr/share/vala-0.20/vapi/glib-2.0.vapi"
		return result;
#line 1330 "midori-hsts.c"
	}
}


static void midori_hsts_strict_transport_security_handled (MidoriHSTS* self, SoupMessage* message) {
	gboolean _tmp0_ = FALSE;
	SoupMessage* _tmp1_;
	gboolean _tmp5_;
	SoupMessage* _tmp6_;
	SoupMessageHeaders* _tmp7_;
	const gchar* _tmp8_ = NULL;
	const gchar* hsts;
	const gchar* _tmp9_;
	const gchar* _tmp10_;
	MidoriHSTSDirective* _tmp11_;
	MidoriHSTSDirective* directive;
	MidoriHSTSDirective* _tmp12_;
	gboolean _tmp13_ = FALSE;
	gboolean _tmp24_;
#line 126 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	g_return_if_fail (self != NULL);
#line 126 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	g_return_if_fail (message != NULL);
#line 127 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_tmp1_ = message;
#line 127 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	if (_tmp1_ == NULL) {
#line 127 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_tmp0_ = TRUE;
#line 1360 "midori-hsts.c"
	} else {
		SoupMessage* _tmp2_;
		SoupURI* _tmp3_;
		SoupURI* _tmp4_;
#line 127 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_tmp2_ = message;
#line 127 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_tmp3_ = soup_message_get_uri (_tmp2_);
#line 127 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_tmp4_ = _tmp3_;
#line 127 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_tmp0_ = _tmp4_ == NULL;
#line 1373 "midori-hsts.c"
	}
#line 127 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_tmp5_ = _tmp0_;
#line 127 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	if (_tmp5_) {
#line 128 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		return;
#line 1381 "midori-hsts.c"
	}
#line 130 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_tmp6_ = message;
#line 130 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_tmp7_ = _tmp6_->response_headers;
#line 130 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_tmp8_ = soup_message_headers_get_one (_tmp7_, "Strict-Transport-Security");
#line 130 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	hsts = _tmp8_;
#line 131 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_tmp9_ = hsts;
#line 131 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	if (_tmp9_ == NULL) {
#line 132 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		return;
#line 1397 "midori-hsts.c"
	}
#line 134 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_tmp10_ = hsts;
#line 134 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_tmp11_ = midori_hsts_directive_new_from_header (_tmp10_);
#line 134 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	directive = _tmp11_;
#line 135 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_tmp12_ = directive;
#line 135 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_tmp13_ = midori_hsts_directive_is_valid (_tmp12_);
#line 135 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	if (_tmp13_) {
#line 1411 "midori-hsts.c"
		SoupMessage* _tmp14_;
		SoupURI* _tmp15_;
		SoupURI* _tmp16_;
		const gchar* _tmp17_;
		MidoriHSTSDirective* _tmp18_;
		SoupMessage* _tmp19_;
		SoupURI* _tmp20_;
		SoupURI* _tmp21_;
		const gchar* _tmp22_;
		const gchar* _tmp23_;
#line 136 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_tmp14_ = message;
#line 136 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_tmp15_ = soup_message_get_uri (_tmp14_);
#line 136 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_tmp16_ = _tmp15_;
#line 136 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_tmp17_ = _tmp16_->host;
#line 136 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_tmp18_ = directive;
#line 136 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		midori_hsts_append_to_whitelist (self, _tmp17_, _tmp18_);
#line 137 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_tmp19_ = message;
#line 137 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_tmp20_ = soup_message_get_uri (_tmp19_);
#line 137 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_tmp21_ = _tmp20_;
#line 137 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_tmp22_ = _tmp21_->host;
#line 137 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_tmp23_ = hsts;
#line 137 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		midori_hsts_append_to_cache (self, _tmp22_, _tmp23_, NULL, NULL);
#line 1446 "midori-hsts.c"
	}
#line 139 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_tmp24_ = self->priv->debug;
#line 139 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	if (_tmp24_) {
#line 1452 "midori-hsts.c"
		FILE* _tmp25_;
		SoupMessage* _tmp26_;
		SoupURI* _tmp27_;
		SoupURI* _tmp28_;
		const gchar* _tmp29_;
		const gchar* _tmp30_;
		MidoriHSTSDirective* _tmp31_;
		gboolean _tmp32_ = FALSE;
		gchar* _tmp33_ = NULL;
		gchar* _tmp34_;
#line 140 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_tmp25_ = stdout;
#line 140 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_tmp26_ = message;
#line 140 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_tmp27_ = soup_message_get_uri (_tmp26_);
#line 140 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_tmp28_ = _tmp27_;
#line 140 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_tmp29_ = _tmp28_->host;
#line 140 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_tmp30_ = hsts;
#line 140 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_tmp31_ = directive;
#line 140 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_tmp32_ = midori_hsts_directive_is_valid (_tmp31_);
#line 140 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_tmp33_ = bool_to_string (_tmp32_);
#line 140 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_tmp34_ = _tmp33_;
#line 140 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		fprintf (_tmp25_, "HSTS: '%s' sets '%s' valid? %s\n", _tmp29_, _tmp30_, _tmp34_);
#line 140 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_g_free0 (_tmp34_);
#line 1487 "midori-hsts.c"
	}
#line 126 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_midori_hsts_directive_unref0 (directive);
#line 1491 "midori-hsts.c"
}


static void _vala_SoupDate_free (SoupDate* self) {
#line 15 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	g_boxed_free (soup_date_get_type (), self);
#line 1498 "midori-hsts.c"
}


MidoriHSTSDirective* midori_hsts_directive_construct (GType object_type, gboolean include_sub_domains) {
	MidoriHSTSDirective* self = NULL;
	gint _tmp0_;
	SoupDate* _tmp1_;
	gboolean _tmp2_;
#line 18 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	self = (MidoriHSTSDirective*) g_type_create_instance (object_type);
#line 19 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_tmp0_ = G_MAXINT;
#line 19 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_tmp1_ = soup_date_new_from_now (_tmp0_);
#line 19 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	__vala_SoupDate_free0 (self->expires);
#line 19 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	self->expires = _tmp1_;
#line 20 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_tmp2_ = include_sub_domains;
#line 20 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	self->sub_domains = _tmp2_;
#line 18 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	return self;
#line 1523 "midori-hsts.c"
}


MidoriHSTSDirective* midori_hsts_directive_new (gboolean include_sub_domains) {
#line 18 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	return midori_hsts_directive_construct (MIDORI_HSTS_TYPE_DIRECTIVE, include_sub_domains);
#line 1530 "midori-hsts.c"
}


static gboolean string_contains (const gchar* self, const gchar* needle) {
	gboolean result = FALSE;
	const gchar* _tmp0_;
	gchar* _tmp1_ = NULL;
#line 1238 "/usr/share/vala-0.20/vapi/glib-2.0.vapi"
	g_return_val_if_fail (self != NULL, FALSE);
#line 1238 "/usr/share/vala-0.20/vapi/glib-2.0.vapi"
	g_return_val_if_fail (needle != NULL, FALSE);
#line 1239 "/usr/share/vala-0.20/vapi/glib-2.0.vapi"
	_tmp0_ = needle;
#line 1239 "/usr/share/vala-0.20/vapi/glib-2.0.vapi"
	_tmp1_ = strstr ((gchar*) self, (gchar*) _tmp0_);
#line 1239 "/usr/share/vala-0.20/vapi/glib-2.0.vapi"
	result = _tmp1_ != NULL;
#line 1239 "/usr/share/vala-0.20/vapi/glib-2.0.vapi"
	return result;
#line 1550 "midori-hsts.c"
}


MidoriHSTSDirective* midori_hsts_directive_construct_from_header (GType object_type, const gchar* header) {
	MidoriHSTSDirective* self = NULL;
	const gchar* _tmp0_;
	GHashTable* _tmp1_ = NULL;
	GHashTable* param_list;
	GHashTable* _tmp2_;
	GHashTable* _tmp3_;
	gconstpointer _tmp4_ = NULL;
	gchar* _tmp5_;
	gchar* max_age;
	const gchar* _tmp6_;
	const gchar* _tmp10_;
	gboolean _tmp11_ = FALSE;
	GHashTable* _tmp12_;
#line 23 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	g_return_val_if_fail (header != NULL, NULL);
#line 23 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	self = (MidoriHSTSDirective*) g_type_create_instance (object_type);
#line 24 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_tmp0_ = header;
#line 24 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_tmp1_ = soup_header_parse_param_list (_tmp0_);
#line 24 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	param_list = _tmp1_;
#line 25 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_tmp2_ = param_list;
#line 25 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	if (_tmp2_ == NULL) {
#line 26 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_g_hash_table_unref0 (param_list);
#line 26 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		return self;
#line 1586 "midori-hsts.c"
	}
#line 28 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_tmp3_ = param_list;
#line 28 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_tmp4_ = g_hash_table_lookup (_tmp3_, "max-age");
#line 28 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_tmp5_ = g_strdup ((const gchar*) _tmp4_);
#line 28 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	max_age = _tmp5_;
#line 29 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_tmp6_ = max_age;
#line 29 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	if (_tmp6_ != NULL) {
#line 1600 "midori-hsts.c"
		const gchar* _tmp7_;
		gint _tmp8_ = 0;
		SoupDate* _tmp9_;
#line 30 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_tmp7_ = max_age;
#line 30 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_tmp8_ = atoi (_tmp7_);
#line 30 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_tmp9_ = soup_date_new_from_now (_tmp8_);
#line 30 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		__vala_SoupDate_free0 (self->expires);
#line 30 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		self->expires = _tmp9_;
#line 1614 "midori-hsts.c"
	}
#line 32 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_tmp10_ = header;
#line 32 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_tmp11_ = string_contains (_tmp10_, "includeSubDomains");
#line 32 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	if (_tmp11_) {
#line 33 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		self->sub_domains = TRUE;
#line 1624 "midori-hsts.c"
	}
#line 34 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_tmp12_ = param_list;
#line 34 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	soup_header_free_param_list (_tmp12_);
#line 23 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_g_free0 (max_age);
#line 23 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_g_hash_table_unref0 (param_list);
#line 23 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	return self;
#line 1636 "midori-hsts.c"
}


MidoriHSTSDirective* midori_hsts_directive_new_from_header (const gchar* header) {
#line 23 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	return midori_hsts_directive_construct_from_header (MIDORI_HSTS_TYPE_DIRECTIVE, header);
#line 1643 "midori-hsts.c"
}


gboolean midori_hsts_directive_is_valid (MidoriHSTSDirective* self) {
	gboolean result = FALSE;
	gboolean _tmp0_ = FALSE;
	SoupDate* _tmp1_;
	gboolean _tmp4_;
#line 37 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	g_return_val_if_fail (self != NULL, FALSE);
#line 38 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_tmp1_ = self->expires;
#line 38 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	if (_tmp1_ != NULL) {
#line 1658 "midori-hsts.c"
		SoupDate* _tmp2_;
		gboolean _tmp3_ = FALSE;
#line 38 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_tmp2_ = self->expires;
#line 38 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_tmp3_ = soup_date_is_past (_tmp2_);
#line 38 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_tmp0_ = !_tmp3_;
#line 1667 "midori-hsts.c"
	} else {
#line 38 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		_tmp0_ = FALSE;
#line 1671 "midori-hsts.c"
	}
#line 38 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_tmp4_ = _tmp0_;
#line 38 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	result = _tmp4_;
#line 38 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	return result;
#line 1679 "midori-hsts.c"
}


static void midori_hsts_value_directive_init (GValue* value) {
#line 14 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	value->data[0].v_pointer = NULL;
#line 1686 "midori-hsts.c"
}


static void midori_hsts_value_directive_free_value (GValue* value) {
#line 14 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	if (value->data[0].v_pointer) {
#line 14 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		midori_hsts_directive_unref (value->data[0].v_pointer);
#line 1695 "midori-hsts.c"
	}
}


static void midori_hsts_value_directive_copy_value (const GValue* src_value, GValue* dest_value) {
#line 14 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	if (src_value->data[0].v_pointer) {
#line 14 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		dest_value->data[0].v_pointer = midori_hsts_directive_ref (src_value->data[0].v_pointer);
#line 1705 "midori-hsts.c"
	} else {
#line 14 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		dest_value->data[0].v_pointer = NULL;
#line 1709 "midori-hsts.c"
	}
}


static gpointer midori_hsts_value_directive_peek_pointer (const GValue* value) {
#line 14 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	return value->data[0].v_pointer;
#line 1717 "midori-hsts.c"
}


static gchar* midori_hsts_value_directive_collect_value (GValue* value, guint n_collect_values, GTypeCValue* collect_values, guint collect_flags) {
#line 14 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	if (collect_values[0].v_pointer) {
#line 1724 "midori-hsts.c"
		MidoriHSTSDirective* object;
		object = collect_values[0].v_pointer;
#line 14 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		if (object->parent_instance.g_class == NULL) {
#line 14 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
			return g_strconcat ("invalid unclassed object pointer for value type `", G_VALUE_TYPE_NAME (value), "'", NULL);
#line 1731 "midori-hsts.c"
		} else if (!g_value_type_compatible (G_TYPE_FROM_INSTANCE (object), G_VALUE_TYPE (value))) {
#line 14 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
			return g_strconcat ("invalid object type `", g_type_name (G_TYPE_FROM_INSTANCE (object)), "' for value type `", G_VALUE_TYPE_NAME (value), "'", NULL);
#line 1735 "midori-hsts.c"
		}
#line 14 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		value->data[0].v_pointer = midori_hsts_directive_ref (object);
#line 1739 "midori-hsts.c"
	} else {
#line 14 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		value->data[0].v_pointer = NULL;
#line 1743 "midori-hsts.c"
	}
#line 14 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	return NULL;
#line 1747 "midori-hsts.c"
}


static gchar* midori_hsts_value_directive_lcopy_value (const GValue* value, guint n_collect_values, GTypeCValue* collect_values, guint collect_flags) {
	MidoriHSTSDirective** object_p;
	object_p = collect_values[0].v_pointer;
#line 14 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	if (!object_p) {
#line 14 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		return g_strdup_printf ("value location for `%s' passed as NULL", G_VALUE_TYPE_NAME (value));
#line 1758 "midori-hsts.c"
	}
#line 14 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	if (!value->data[0].v_pointer) {
#line 14 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		*object_p = NULL;
#line 1764 "midori-hsts.c"
	} else if (collect_flags & G_VALUE_NOCOPY_CONTENTS) {
#line 14 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		*object_p = value->data[0].v_pointer;
#line 1768 "midori-hsts.c"
	} else {
#line 14 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		*object_p = midori_hsts_directive_ref (value->data[0].v_pointer);
#line 1772 "midori-hsts.c"
	}
#line 14 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	return NULL;
#line 1776 "midori-hsts.c"
}


GParamSpec* midori_hsts_param_spec_directive (const gchar* name, const gchar* nick, const gchar* blurb, GType object_type, GParamFlags flags) {
	MidoriHSTSParamSpecDirective* spec;
#line 14 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	g_return_val_if_fail (g_type_is_a (object_type, MIDORI_HSTS_TYPE_DIRECTIVE), NULL);
#line 14 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	spec = g_param_spec_internal (G_TYPE_PARAM_OBJECT, name, nick, blurb, flags);
#line 14 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	G_PARAM_SPEC (spec)->value_type = object_type;
#line 14 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	return G_PARAM_SPEC (spec);
#line 1790 "midori-hsts.c"
}


gpointer midori_hsts_value_get_directive (const GValue* value) {
#line 14 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	g_return_val_if_fail (G_TYPE_CHECK_VALUE_TYPE (value, MIDORI_HSTS_TYPE_DIRECTIVE), NULL);
#line 14 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	return value->data[0].v_pointer;
#line 1799 "midori-hsts.c"
}


void midori_hsts_value_set_directive (GValue* value, gpointer v_object) {
	MidoriHSTSDirective* old;
#line 14 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	g_return_if_fail (G_TYPE_CHECK_VALUE_TYPE (value, MIDORI_HSTS_TYPE_DIRECTIVE));
#line 14 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	old = value->data[0].v_pointer;
#line 14 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	if (v_object) {
#line 14 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		g_return_if_fail (G_TYPE_CHECK_INSTANCE_TYPE (v_object, MIDORI_HSTS_TYPE_DIRECTIVE));
#line 14 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		g_return_if_fail (g_value_type_compatible (G_TYPE_FROM_INSTANCE (v_object), G_VALUE_TYPE (value)));
#line 14 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		value->data[0].v_pointer = v_object;
#line 14 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		midori_hsts_directive_ref (value->data[0].v_pointer);
#line 1819 "midori-hsts.c"
	} else {
#line 14 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		value->data[0].v_pointer = NULL;
#line 1823 "midori-hsts.c"
	}
#line 14 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	if (old) {
#line 14 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		midori_hsts_directive_unref (old);
#line 1829 "midori-hsts.c"
	}
}


void midori_hsts_value_take_directive (GValue* value, gpointer v_object) {
	MidoriHSTSDirective* old;
#line 14 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	g_return_if_fail (G_TYPE_CHECK_VALUE_TYPE (value, MIDORI_HSTS_TYPE_DIRECTIVE));
#line 14 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	old = value->data[0].v_pointer;
#line 14 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	if (v_object) {
#line 14 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		g_return_if_fail (G_TYPE_CHECK_INSTANCE_TYPE (v_object, MIDORI_HSTS_TYPE_DIRECTIVE));
#line 14 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		g_return_if_fail (g_value_type_compatible (G_TYPE_FROM_INSTANCE (v_object), G_VALUE_TYPE (value)));
#line 14 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		value->data[0].v_pointer = v_object;
#line 1848 "midori-hsts.c"
	} else {
#line 14 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		value->data[0].v_pointer = NULL;
#line 1852 "midori-hsts.c"
	}
#line 14 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	if (old) {
#line 14 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		midori_hsts_directive_unref (old);
#line 1858 "midori-hsts.c"
	}
}


static void midori_hsts_directive_class_init (MidoriHSTSDirectiveClass * klass) {
#line 14 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	midori_hsts_directive_parent_class = g_type_class_peek_parent (klass);
#line 14 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	MIDORI_HSTS_DIRECTIVE_CLASS (klass)->finalize = midori_hsts_directive_finalize;
#line 1868 "midori-hsts.c"
}


static void midori_hsts_directive_instance_init (MidoriHSTSDirective * self) {
#line 15 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	self->expires = NULL;
#line 16 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	self->sub_domains = FALSE;
#line 14 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	self->ref_count = 1;
#line 1879 "midori-hsts.c"
}


static void midori_hsts_directive_finalize (MidoriHSTSDirective* obj) {
	MidoriHSTSDirective * self;
#line 14 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	self = G_TYPE_CHECK_INSTANCE_CAST (obj, MIDORI_HSTS_TYPE_DIRECTIVE, MidoriHSTSDirective);
#line 15 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	__vala_SoupDate_free0 (self->expires);
#line 1889 "midori-hsts.c"
}


GType midori_hsts_directive_get_type (void) {
	static volatile gsize midori_hsts_directive_type_id__volatile = 0;
	if (g_once_init_enter (&midori_hsts_directive_type_id__volatile)) {
		static const GTypeValueTable g_define_type_value_table = { midori_hsts_value_directive_init, midori_hsts_value_directive_free_value, midori_hsts_value_directive_copy_value, midori_hsts_value_directive_peek_pointer, "p", midori_hsts_value_directive_collect_value, "p", midori_hsts_value_directive_lcopy_value };
		static const GTypeInfo g_define_type_info = { sizeof (MidoriHSTSDirectiveClass), (GBaseInitFunc) NULL, (GBaseFinalizeFunc) NULL, (GClassInitFunc) midori_hsts_directive_class_init, (GClassFinalizeFunc) NULL, NULL, sizeof (MidoriHSTSDirective), 0, (GInstanceInitFunc) midori_hsts_directive_instance_init, &g_define_type_value_table };
		static const GTypeFundamentalInfo g_define_type_fundamental_info = { (G_TYPE_FLAG_CLASSED | G_TYPE_FLAG_INSTANTIATABLE | G_TYPE_FLAG_DERIVABLE | G_TYPE_FLAG_DEEP_DERIVABLE) };
		GType midori_hsts_directive_type_id;
		midori_hsts_directive_type_id = g_type_register_fundamental (g_type_fundamental_next (), "MidoriHSTSDirective", &g_define_type_info, &g_define_type_fundamental_info, 0);
		g_once_init_leave (&midori_hsts_directive_type_id__volatile, midori_hsts_directive_type_id);
	}
	return midori_hsts_directive_type_id__volatile;
}


gpointer midori_hsts_directive_ref (gpointer instance) {
	MidoriHSTSDirective* self;
	self = instance;
#line 14 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	g_atomic_int_inc (&self->ref_count);
#line 14 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	return instance;
#line 1914 "midori-hsts.c"
}


void midori_hsts_directive_unref (gpointer instance) {
	MidoriHSTSDirective* self;
	self = instance;
#line 14 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	if (g_atomic_int_dec_and_test (&self->ref_count)) {
#line 14 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		MIDORI_HSTS_DIRECTIVE_GET_CLASS (self)->finalize (self);
#line 14 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
		g_type_free_instance ((GTypeInstance *) self);
#line 1927 "midori-hsts.c"
	}
}


static void midori_hsts_class_init (MidoriHSTSClass * klass) {
#line 13 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	midori_hsts_parent_class = g_type_class_peek_parent (klass);
#line 13 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	g_type_class_add_private (klass, sizeof (MidoriHSTSPrivate));
#line 13 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	G_OBJECT_CLASS (klass)->finalize = midori_hsts_finalize;
#line 1939 "midori-hsts.c"
}


static void midori_hsts_soup_session_feature_interface_init (SoupSessionFeatureInterface * iface) {
#line 13 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	midori_hsts_soup_session_feature_parent_iface = g_type_interface_peek_parent (iface);
#line 13 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	iface->add_feature = (gboolean (*)(SoupSessionFeature*, GType)) midori_hsts_real_add_feature;
#line 13 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	iface->remove_feature = (gboolean (*)(SoupSessionFeature*, GType)) midori_hsts_real_remove_feature;
#line 13 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	iface->has_feature = (gboolean (*)(SoupSessionFeature*, GType)) midori_hsts_real_has_feature;
#line 13 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	iface->attach = (void (*)(SoupSessionFeature*, SoupSession*)) midori_hsts_real_attach;
#line 13 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	iface->detach = (void (*)(SoupSessionFeature*, SoupSession*)) midori_hsts_real_detach;
#line 13 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	iface->request_started = (void (*)(SoupSessionFeature*, SoupSession*, SoupMessage*, SoupSocket*)) midori_hsts_real_request_started;
#line 13 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	iface->request_queued = (void (*)(SoupSessionFeature*, SoupSession*, SoupMessage*)) midori_hsts_real_request_queued;
#line 13 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	iface->request_unqueued = (void (*)(SoupSessionFeature*, SoupSession*, SoupMessage*)) midori_hsts_real_request_unqueued;
#line 1962 "midori-hsts.c"
}


static void midori_hsts_instance_init (MidoriHSTS * self) {
#line 13 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	self->priv = MIDORI_HSTS_GET_PRIVATE (self);
#line 43 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	self->priv->debug = FALSE;
#line 1971 "midori-hsts.c"
}


static void midori_hsts_finalize (GObject* obj) {
	MidoriHSTS * self;
#line 13 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	self = G_TYPE_CHECK_INSTANCE_CAST (obj, MIDORI_TYPE_HSTS, MidoriHSTS);
#line 42 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	_g_hash_table_unref0 (self->priv->whitelist);
#line 13 "/home/zrl/epiphany_webkit/Webkit2Browser/Source/midori/katze/midori-hsts.vala"
	G_OBJECT_CLASS (midori_hsts_parent_class)->finalize (obj);
#line 1983 "midori-hsts.c"
}


GType midori_hsts_get_type (void) {
	static volatile gsize midori_hsts_type_id__volatile = 0;
	if (g_once_init_enter (&midori_hsts_type_id__volatile)) {
		static const GTypeInfo g_define_type_info = { sizeof (MidoriHSTSClass), (GBaseInitFunc) NULL, (GBaseFinalizeFunc) NULL, (GClassInitFunc) midori_hsts_class_init, (GClassFinalizeFunc) NULL, NULL, sizeof (MidoriHSTS), 0, (GInstanceInitFunc) midori_hsts_instance_init, NULL };
		static const GInterfaceInfo soup_session_feature_info = { (GInterfaceInitFunc) midori_hsts_soup_session_feature_interface_init, (GInterfaceFinalizeFunc) NULL, NULL};
		GType midori_hsts_type_id;
		midori_hsts_type_id = g_type_register_static (G_TYPE_OBJECT, "MidoriHSTS", &g_define_type_info, 0);
		g_type_add_interface_static (midori_hsts_type_id, soup_session_feature_get_type (), &soup_session_feature_info);
		g_once_init_leave (&midori_hsts_type_id__volatile, midori_hsts_type_id);
	}
	return midori_hsts_type_id__volatile;
}


static void _vala_array_destroy (gpointer array, gint array_length, GDestroyNotify destroy_func) {
	if ((array != NULL) && (destroy_func != NULL)) {
		int i;
		for (i = 0; i < array_length; i = i + 1) {
			if (((gpointer*) array)[i] != NULL) {
				destroy_func (((gpointer*) array)[i]);
			}
		}
	}
}


static void _vala_array_free (gpointer array, gint array_length, GDestroyNotify destroy_func) {
	_vala_array_destroy (array, array_length, destroy_func);
	g_free (array);
}


static gint _vala_array_length (gpointer array) {
	int length;
	length = 0;
	if (array) {
		while (((gpointer*) array)[length]) {
			length++;
		}
	}
	return length;
}



